{% extends "management/season_detail.html" %}
{% load staticfiles %}
{% load bootstrap_tags %}
{% load i18n %}

{% block extrastyle %}
<link rel="stylesheet" href="{% static 'chosen_v1.1.0/chosen.css' %}" type='text/css'>
<style type='text/css'>
	#save_player{
		padding: 2px 12px;
	}
	tfoot{
		border-top: 2px solid #ddd;
	}
	@media print {
       table td:last-child {display:none;}
       table th:last-child {display:none;}
       tfoot {display:none;}
       #print-button {display: none;}
   	}
    .form-group{
    	margin-bottom: 0;
    	margin-left:5%;
    	margin-right: 5%;
    }
    .form-control{
    	height: 28px;
    }
</style>
{% endblock %}
{% block header %}
<h1>{{name}} {{year}} <small>Roster</small></h1>
{% endblock %}

{% block content %}
<div id="#roster">
	<table class="table table-bordered table-striped tablesorter" id="player_list">
		<thead>
			<tr class="text-center">
				<th class="text-center">Last Name</th>
				<th class="text-center">First Name</th>
				<th class="text-center">Position</th>
				<th class="text-center">Class</th>
				<th class="text-center">Throw/Hit</th>
				<th class="text-center no-sort">Delete</th>
			</tr>
		</thead>
		<tbody>
			{% for p in players %}
			<tr>
				<td class="text-center">{{p.last_name}}</td>
				<td class="text-center">{{p.first_name}}</td>
				<td class="text-center">{{p.position.all|join:" / " }}</td>
				<td class="text-center">{{p.class_standing}}</td>
				<td class="text-center">{{p.throws}}/{{p.hits}}</td>
				<td class="text-center">
					<form action="" class="delete_form" method=post>
						{% csrf_token %}
						<input type="hidden" value="{{p.id}}" name="delete">
						<button type="submit" class="btn btn-danger btn-xs delete_btn"><i class="fa fa-trash-o"></i></button>
					</form>
				</td>
			</tr>
			{% endfor %}
		</tbody>
		<tfoot>
			<form id="playerform" class="form-inline add_form" action="{% url 'player_list' username=user name=name year=year %}" method=post>
				{% csrf_token %}
				<tr class="text-center">
					<th id="season_id" style="display:none;">{{form.season}}</th>
					<th class="text-center">
						<div class="form-group">
							<input id="id_last_name" class="form-control" maxlength="50" name="last_name" type="text" placeholder="Last Name">
						</div>
					</th>
					<th class="text-center">
						<div class="form-group">
							<input id="id_first_name" class="form-control" maxlength="50" name="first_name" type="text" placeholder="First Name">
						</div>
					</th>
					<th class="text-center">{{form.position}}</th>
					<th class="text-center">
						<select id="id_class_standing" name="class_standing">
							<option value="" selected="selected">Class</option>
							<option value="Fr">Freshman</option>
							<option value="So">Sophomore</option>
							<option value="Jr">Junior</option>
							<option value="Sr">Senior</option>
							<option value="O">Other</option>
						</select>
					</th>
					<th class="text-center">
						<select id="id_throws" name="throws">
							<option value="" selected="selected">Throws</option>
							<option value="L">Left</option>
							<option value="R">Right</option>
						</select>
						/
						<select id="id_hits" name="hits">
							<option value="" selected="selected">Hits</option>
							<option value="L">Left</option>
							<option value="R">Right</option>
							<option value="S">Switch</option>
						</select>
					</th>
					<th class="text-center no-sort"><button type="submit" class="btn btn-primary" id="save_player">Save</button></th>
				</tr>
			</form>
		</tfoot>
	</table>
</div>
<a href="javascript:window.print()"><button id="print-button" class="btn btn-primary"><i class="fa fa-print"></i> Print</button></a>
{% endblock %}

{% block extrascript %}
<script type='text/javascript' src="{% static 'chosen_v1.1.0/chosen.jquery.js' %}"></script>
<script type='text/javascript' src="{% static 'js/tablesort.min.js' %}"></script>
<script type='text/javascript'>
	new Tablesort(document.getElementById('player_list'));

	$("#id_position").chosen({width: "140px", placeholder_text_multiple: "Positions"});

	var season = {{team.id}};
	$('select[name="season"]').val(season);

	$('.delete_form').submit(function (e) {
		$.ajax({
			type: 'post',
			url : "{% url 'player_list' username=user name=name year=year %}",
			data : $(this).serialize(),
			success: function(data){
				$('#roster').html(data);
			}
		});
	});

	$('.add_form').submit(function (e) {
		$.ajax({
			type: 'post',
			url : "{% url 'player_list' username=user name=name year=year %}",
			data : $(this).serialize(),
			success: function(data){
				$('#roster').html(data);
			}
		});
	});
</script>
{% endblock %}